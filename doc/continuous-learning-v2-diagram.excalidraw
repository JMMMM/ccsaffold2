{
  "type": "excalidraw",
  "version": 2,
  "source": "claude-code-analysis",
  "elements": [
    {"id":"title-bg","type":"rectangle","x":0,"y":0,"width":1100,"height":60,"backgroundColor":"#1a1a2e","strokeColor":"#1a1a2e","strokeWidth":1,"fillStyle":"solid","roughness":0,"opacity":100},
    {"id":"title","type":"text","x":350,"y":18,"text":"Continuous Learning v2 架构总览","fontSize":28,"fontFamily":1,"textAlign":"center","strokeColor":"#ffffff","backgroundColor":"transparent"},

    {"id":"session-box","type":"rectangle","x":20,"y":80,"width":220,"height":250,"backgroundColor":"#f8f9fa","strokeColor":"#343a40","strokeWidth":2},
    {"id":"session-title","type":"text","x":45,"y":90,"text":"1. Claude Code 会话","fontSize":16,"fontFamily":1,"strokeColor":"#000000"},
    {"id":"prehook","type":"rectangle","x":40,"y":120,"width":180,"height":40,"backgroundColor":"#339af0","strokeColor":"#1971c2"},
    {"id":"prehook-text","type":"text","x":75,"y":133,"text":"PreToolUse Hook","fontSize":12},
    {"id":"posthook","type":"rectangle","x":40,"y":170,"width":180,"height":40,"backgroundColor":"#339af0","strokeColor":"#1971c2"},
    {"id":"posthook-text","type":"text","x":70,"y":183,"text":"PostToolUse Hook","fontSize":12},
    {"id":"observe","type":"rectangle","x":40,"y":220,"width":180,"height":40,"backgroundColor":"#fcc419","strokeColor":"#e67700"},
    {"id":"observe-text","type":"text","x":95,"y":233,"text":"observe.sh","fontSize":12},
    {"id":"session-note","type":"text","x":80,"y":275,"text":"100% 可靠捕获","fontSize":10,"fontFamily":1},

    {"id":"data-box","type":"rectangle","x":280,"y":80,"width":220,"height":250,"backgroundColor":"#f8f9fa","strokeColor":"#343a40","strokeWidth":2},
    {"id":"data-title","type":"text","x":320,"y":90,"text":"2. 数据存储层","fontSize":16,"fontFamily":1},
    {"id":"obs-file","type":"rectangle","x":300,"y":120,"width":180,"height":50,"backgroundColor":"#51cf66","strokeColor":"#2f9e44"},
    {"id":"obs-text","type":"text","x":325,"y":130,"text":"observations.jsonl","fontSize":11},
    {"id":"obs-sub","type":"text","x":355,"y":150,"text":"工具调用记录","fontSize":9},
    {"id":"archive","type":"rectangle","x":300,"y":180,"width":180,"height":50,"backgroundColor":"#fcc419","strokeColor":"#e67700"},
    {"id":"archive-text","type":"text","x":315,"y":190,"text":"observations.archive/","fontSize":11},
    {"id":"archive-sub","type":"text","x":355,"y":210,"text":"已处理归档","fontSize":9},
    {"id":"disabled","type":"rectangle","x":300,"y":245,"width":180,"height":35,"backgroundColor":"#ff922b","strokeColor":"#e8590c"},
    {"id":"disabled-text","type":"text","x":320,"y":257,"text":"disabled (开关标记)","fontSize":10},

    {"id":"observer-box","type":"rectangle","x":540,"y":80,"width":220,"height":250,"backgroundColor":"#f8f9fa","strokeColor":"#343a40","strokeWidth":2},
    {"id":"observer-title","type":"text","x":585,"y":90,"text":"3. 观察者代理","fontSize":16,"fontFamily":1},
    {"id":"start-obs","type":"rectangle","x":560,"y":120,"width":180,"height":40,"backgroundColor":"#be4bdb","strokeColor":"#862e9c"},
    {"id":"start-obs-text","type":"text","x":590,"y":133,"text":"start-observer.sh","fontSize":11},
    {"id":"obs-agent","type":"rectangle","x":560,"y":170,"width":180,"height":40,"backgroundColor":"#9c36b5","strokeColor":"#7048e8"},
    {"id":"obs-agent-text","type":"text","x":590,"y":183,"text":"observer.md (Agent)","fontSize":11},
    {"id":"haiku","type":"rectangle","x":560,"y":220,"width":180,"height":40,"backgroundColor":"#5c7cfa","strokeColor":"#364fc7"},
    {"id":"haiku-text","type":"text","x":590,"y":233,"text":"Haiku Model 分析","fontSize":11},
    {"id":"trigger","type":"rectangle","x":560,"y":270,"width":180,"height":30,"backgroundColor":"#495057","strokeColor":"#343a40"},
    {"id":"trigger-text","type":"text","x":570,"y":280,"text":"每5分钟 / SIGUSR1 触发","fontSize":9,"fontFamily":1},

    {"id":"instinct-box","type":"rectangle","x":800,"y":80,"width":220,"height":250,"backgroundColor":"#f8f9fa","strokeColor":"#343a40","strokeWidth":2},
    {"id":"instinct-title","type":"text","x":820,"y":90,"text":"4. 本能层 (Instincts)","fontSize":16,"fontFamily":1},
    {"id":"personal","type":"rectangle","x":820,"y":120,"width":180,"height":45,"backgroundColor":"#fa5252","strokeColor":"#c92a2a"},
    {"id":"personal-text","type":"text","x":850,"y":133,"text":"instincts/personal/","fontSize":11},
    {"id":"inherited","type":"rectangle","x":820,"y":175,"width":180,"height":45,"backgroundColor":"#ffc9c9","strokeColor":"#e03131"},
    {"id":"inherited-text","type":"text","x":848,"y":188,"text":"instincts/inherited/","fontSize":11},
    {"id":"confidence","type":"rectangle","x":820,"y":230,"width":180,"height":60,"backgroundColor":"#c92a2a","strokeColor":"#8b0000"},
    {"id":"confidence-text","type":"text","x":855,"y":240,"text":"置信度: 0.3 ~ 0.9","fontSize":11,"fontFamily":1},
    {"id":"confidence-sub","type":"text","x":858,"y":265,"text":"(原子行为模式)","fontSize":10,"fontFamily":1},

    {"id":"arrow1","type":"arrow","x":240,"y":180,"width":40,"height":0,"strokeColor":"#1971c2","strokeWidth":3,"points":[[0,0],[40,0]]},
    {"id":"arrow2","type":"arrow","x":500,"y":180,"width":40,"height":0,"strokeColor":"#1971c2","strokeWidth":3,"points":[[0,0],[40,0]]},
    {"id":"arrow3","type":"arrow","x":760,"y":180,"width":40,"height":0,"strokeColor":"#1971c2","strokeWidth":3,"points":[[0,0],[40,0]]},

    {"id":"evolve-box","type":"rectangle","x":20,"y":360,"width":1000,"height":150,"backgroundColor":"#e9ecef","strokeColor":"#495057","strokeWidth":2},
    {"id":"evolve-title","type":"text","x":350,"y":370,"text":"5. 进化层 (Evolution) - instinct-cli.py","fontSize":16,"fontFamily":1},
    {"id":"cmd1","type":"rectangle","x":40,"y":400,"width":110,"height":40,"backgroundColor":"#20c997","strokeColor":"#099268"},
    {"id":"cmd1-text","type":"text","x":65,"y":413,"text":"/evolve","fontSize":11},
    {"id":"cmd2","type":"rectangle","x":160,"y":400,"width":130,"height":40,"backgroundColor":"#38d9a9","strokeColor":"#12b886"},
    {"id":"cmd2-text","type":"text","x":175,"y":413,"text":"/instinct-status","fontSize":10},
    {"id":"cmd3","type":"rectangle","x":300,"y":400,"width":130,"height":40,"backgroundColor":"#63e6be","strokeColor":"#20c997"},
    {"id":"cmd3-text","type":"text","x":315,"y":413,"text":"/instinct-export","fontSize":10},
    {"id":"cmd4","type":"rectangle","x":440,"y":400,"width":130,"height":40,"backgroundColor":"#96f2d7","strokeColor":"#38d9a9"},
    {"id":"cmd4-text","type":"text","x":458,"y":413,"text":"/instinct-import","fontSize":10},
    {"id":"out1","type":"rectangle","x":40,"y":455,"width":140,"height":35,"backgroundColor":"#0ca678","strokeColor":"#087f5b"},
    {"id":"out1-text","type":"text","x":70,"y":465,"text":"evolved/skills/","fontSize":10},
    {"id":"out2","type":"rectangle","x":190,"y":455,"width":140,"height":35,"backgroundColor":"#0ca678","strokeColor":"#087f5b"},
    {"id":"out2-text","type":"text","x":210,"y":465,"text":"evolved/commands/","fontSize":10},
    {"id":"out3","type":"rectangle","x":340,"y":455,"width":140,"height":35,"backgroundColor":"#0ca678","strokeColor":"#087f5b"},
    {"id":"out3-text","type":"text","x":370,"y":465,"text":"evolved/agents/","fontSize":10},

    {"id":"v1v2-title-bg","type":"rectangle","x":20,"y":540,"width":1000,"height":50,"backgroundColor":"#1a1a2e","strokeColor":"#1a1a2e"},
    {"id":"v1v2-title","type":"text","x":430,"y":555,"text":"v1 vs v2 对比","fontSize":20,"fontFamily":1},

    {"id":"v1-box","type":"rectangle","x":20,"y":600,"width":470,"height":180,"backgroundColor":"#868e96","strokeColor":"#495057","strokeWidth":2},
    {"id":"v1-title","type":"text","x":150,"y":615,"text":"v1: continuous-learning","fontSize":16,"fontFamily":1},
    {"id":"v1-1","type":"text","x":40,"y":645,"text":"• Stop Hook 触发 (会话结束时)","fontSize":12},
    {"id":"v1-2","type":"text","x":40,"y":670,"text":"• evaluate-session.js 评估会话","fontSize":12},
    {"id":"v1-3","type":"text","x":40,"y":695,"text":"• 生成完整 Skills 到 learned/","fontSize":12},
    {"id":"v1-4","type":"text","x":40,"y":720,"text":"• 无置信度评分机制","fontSize":12},
    {"id":"v1-5","type":"text","x":40,"y":745,"text":"• 依赖 Skill 匹配 (50-80% 可靠性)","fontSize":12},

    {"id":"v2-box","type":"rectangle","x":510,"y":600,"width":510,"height":180,"backgroundColor":"#4c6ef5","strokeColor":"#364fc7","strokeWidth":2},
    {"id":"v2-title","type":"text","x":660,"y":615,"text":"v2: continuous-learning-v2","fontSize":16,"fontFamily":1},
    {"id":"v2-1","type":"text","x":530,"y":645,"text":"• PreToolUse/PostToolUse Hooks (100% 可靠)","fontSize":12},
    {"id":"v2-2","type":"text","x":530,"y":670,"text":"• 后台 Observer Agent (Haiku 模型)","fontSize":12},
    {"id":"v2-3","type":"text","x":530,"y":695,"text":"• 生成原子 Instincts (personal/inherited)","fontSize":12},
    {"id":"v2-4","type":"text","x":530,"y":720,"text":"• 置信度评分 0.3-0.9 动态调整","fontSize":12},
    {"id":"v2-5","type":"text","x":530,"y":745,"text":"• 支持导出/导入本能 分享学习成果","fontSize":12},

    {"id":"file-box","type":"rectangle","x":20,"y":810,"width":320,"height":200,"backgroundColor":"#212529","strokeColor":"#343a40","strokeWidth":2},
    {"id":"file-title","type":"text","x":130,"y":820,"text":"文件结构","fontSize":14,"fontFamily":1,"strokeColor":"#ffffff"},
    {"id":"file-1","type":"text","x":40,"y":845,"text":"~/.claude/homunculus/","fontSize":10,"fontFamily":3,"strokeColor":"#adb5bd"},
    {"id":"file-2","type":"text","x":40,"y":865,"text":"├── identity.json","fontSize":10,"fontFamily":3,"strokeColor":"#adb5bd"},
    {"id":"file-3","type":"text","x":40,"y":885,"text":"├── observations.jsonl","fontSize":10,"fontFamily":3,"strokeColor":"#adb5bd"},
    {"id":"file-4","type":"text","x":40,"y":905,"text":"├── observations.archive/","fontSize":10,"fontFamily":3,"strokeColor":"#adb5bd"},
    {"id":"file-5","type":"text","x":40,"y":925,"text":"├── instincts/","fontSize":10,"fontFamily":3,"strokeColor":"#adb5bd"},
    {"id":"file-6","type":"text","x":40,"y":945,"text":"│   ├── personal/","fontSize":10,"fontFamily":3,"strokeColor":"#adb5bd"},
    {"id":"file-7","type":"text","x":40,"y":965,"text":"│   └── inherited/","fontSize":10,"fontFamily":3,"strokeColor":"#adb5bd"},
    {"id":"file-8","type":"text","x":40,"y":985,"text":"└── evolved/","fontSize":10,"fontFamily":3,"strokeColor":"#adb5bd"},

    {"id":"pattern-box","type":"rectangle","x":360,"y":810,"width":320,"height":200,"backgroundColor":"#212529","strokeColor":"#343a40","strokeWidth":2},
    {"id":"pattern-title","type":"text","x":450,"y":820,"text":"模式检测类型","fontSize":14,"fontFamily":1,"strokeColor":"#ffffff"},
    {"id":"p1","type":"text","x":380,"y":850,"text":"1. User Corrections","fontSize":11,"strokeColor":"#74c0fc"},
    {"id":"p1-sub","type":"text","x":380,"y":870,"text":"   用户纠正 → 创建本能","fontSize":10,"strokeColor":"#adb5bd"},
    {"id":"p2","type":"text","x":380,"y":895,"text":"2. Error Resolutions","fontSize":11,"strokeColor":"#74c0fc"},
    {"id":"p2-sub","type":"text","x":380,"y":915,"text":"   错误解决 → 创建本能","fontSize":10,"strokeColor":"#adb5bd"},
    {"id":"p3","type":"text","x":380,"y":940,"text":"3. Repeated Workflows","fontSize":11,"strokeColor":"#74c0fc"},
    {"id":"p3-sub","type":"text","x":380,"y":960,"text":"   重复工作流 → 创建本能","fontSize":10,"strokeColor":"#adb5bd"},
    {"id":"p4","type":"text","x":380,"y":985,"text":"4. Tool Preferences","fontSize":11,"strokeColor":"#74c0fc"},

    {"id":"conf-box","type":"rectangle","x":700,"y":810,"width":340,"height":200,"backgroundColor":"#212529","strokeColor":"#343a40","strokeWidth":2},
    {"id":"conf-title","type":"text","x":790,"y":820,"text":"置信度计算规则","fontSize":14,"fontFamily":1,"strokeColor":"#ffffff"},
    {"id":"c1","type":"text","x":720,"y":850,"text":"初始置信度 (观察频率):","fontSize":11,"strokeColor":"#ffd43b"},
    {"id":"c2","type":"text","x":720,"y":875,"text":"  1-2次: 0.3 (试探性)","fontSize":10,"strokeColor":"#adb5bd"},
    {"id":"c3","type":"text","x":720,"y":895,"text":"  3-5次: 0.5 (中等)","fontSize":10,"strokeColor":"#adb5bd"},
    {"id":"c4","type":"text","x":720,"y":915,"text":"  6-10次: 0.7 (强)","fontSize":10,"strokeColor":"#adb5bd"},
    {"id":"c5","type":"text","x":720,"y":935,"text":"  11+次: 0.85 (很强)","fontSize":10,"strokeColor":"#adb5bd"},
    {"id":"c6","type":"text","x":720,"y":960,"text":"调整规则:","fontSize":11,"strokeColor":"#ffd43b"},
    {"id":"c7","type":"text","x":720,"y":980,"text":"  +0.05 确认观察  -0.1 矛盾","fontSize":10,"strokeColor":"#adb5bd"},
    {"id":"c8","type":"text","x":720,"y":1000,"text":"  -0.02/周 无观察 (衰减)","fontSize":10,"strokeColor":"#adb5bd"}
  ],
  "appState": {
    "gridSize": null,
    "viewBackgroundColor": "#ffffff",
    "viewModeEnabled": false
  },
  "files": {}
}
