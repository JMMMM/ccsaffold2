{
  "hooks": {
    "PreToolUse": [{
      "matcher": "mcp__web-reader__webReader|mcp__web_reader__webReader",
      "hooks": [{
        "type": "command",
        "command": "node .claude/hooks/web-cache-before.js"
      }],
      "description": "Web-Cache: 检查网站缓存，优先使用已缓存内容"
    }],
    "PostToolUse": [{
      "matcher": "mcp__web-reader__webReader|mcp__web_reader__webReader",
      "hooks": [{
        "type": "prompt",
        "prompt": "Web Reader MCP 返回了内容。请评估并选择性缓存：\n\n## 步骤1：生成缓存键\n- 从URL提取域名（如 docs.nodejs.org）\n- 如果URL有路径，生成：{domain}/{path-slug}-{hash}\n- 如果只有根域名，使用：{domain}\n- 示例：https://docs.nodejs.org/api/fs.html -> docs.nodejs.org/api-fs-html-a1b2c3d4\n\n## 步骤2：始终保存原始 markdown（存档）\n路径：doc/{cache-key}.md\n格式：\n```markdown\n<!--\nSource: {原始URL}\nFetched: {ISO时间戳}\n-->\n\n{原始markdown内容}\n```\n\n## 步骤3：评估是否需要生成 skill\n分析内容并判断：\n\n**需要生成 skill 的内容：**\n- 技术文档（API参考、指南、教程）\n- 可复用的知识模式（最佳实践、约定规范）\n- 值得快速查阅的参考材料\n- 带解释的代码示例\n\n**不需要生成 skill 的内容：**\n- 新闻文章或时效性内容\n- 营销/着陆页\n- 简单的错误页面或重定向\n- 无可复用知识价值的内容\n- 内容单薄的通用页面\n\n## 步骤4：仅在有价值时生成 skill\n如果步骤3判断需要生成，创建：\n路径：skills/learn/{cache-key}/SKILL.md\n格式：\n```markdown\n---\nname: {cache-key}\ndescription: {domain} 网站内容缓存\nsource_url: {原始URL}\ncached_at: {ISO时间戳}\n---\n\n# {domain} 知识摘要\n\n{精炼的核心知识点}\n```\n\n## 注意事项：\n- 原始 markdown 始终保存作为存档\n- skill 生成需要明确的判断依据\n- skill 摘要控制在10KB以内，聚焦可操作的知识点\n- 使用 path slug + hash 避免文件名冲突"
      }],
      "description": "Web-Cache: 保存网站内容到本地缓存（智能判断是否生成skill）"
    }]
  }
}
